<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="search" type="application/opensearchdescription+xml" title="PlatON" href="/alaya-devdocs/en/opensearch.xml">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@8.4.0/dist/mermaid.min.js"></script>
<script src="/alaya-devdocs/js/custom.js"></script><title data-react-helmet="true">DApp Quick Migration Tutorial | PlatON</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://luo-dahui.github.io//alaya-devdocs/en/DApp_migrate"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="DApp Quick Migration Tutorial | PlatON"><meta data-react-helmet="true" name="description" content="Note: This article is based on Alaya DevNet nodes that have been upgraded to an Ethereum-compatible version（0.16.1）. The Ethereum-compatible version of the Alaya mainnet is expected to be released in mid-November."><meta data-react-helmet="true" property="og:description" content="Note: This article is based on Alaya DevNet nodes that have been upgraded to an Ethereum-compatible version（0.16.1）. The Ethereum-compatible version of the Alaya mainnet is expected to be released in mid-November."><meta data-react-helmet="true" property="og:image" content="https://luo-dahui.github.io//alaya-devdocs/en/img/undraw_online.svg"><meta data-react-helmet="true" name="twitter:image" content="https://luo-dahui.github.io//alaya-devdocs/en/img/undraw_online.svg"><link data-react-helmet="true" rel="shortcut icon" href="/alaya-devdocs/en/img/logo.png"><link data-react-helmet="true" rel="canonical" href="https://luo-dahui.github.io//alaya-devdocs/en/DApp_migrate"><link data-react-helmet="true" rel="alternate" href="https://luo-dahui.github.io//alaya-devdocs/en/DApp_migrate" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://luo-dahui.github.io//alaya-devdocs/en/zh-CN/DApp_migrate" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://luo-dahui.github.io//alaya-devdocs/en/DApp_migrate" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/alaya-devdocs/en/assets/css/styles.ccba51f9.css">
<link rel="preload" href="/alaya-devdocs/en/assets/js/runtime~main.e78dac4f.js" as="script">
<link rel="preload" href="/alaya-devdocs/en/assets/js/main.a9c09545.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/alaya-devdocs/en/"><img src="/alaya-devdocs/en/img/alaya-logo.svg" alt="PlatON" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/alaya-devdocs/en/img/alaya-logo.svg" alt="PlatON" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar__items navbar__items--right"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span>English</span></a><ul class="dropdown__menu"><li><a href="/alaya-devdocs/en/DApp_migrate" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li><a href="/alaya-devdocs/zh-CN/DApp_migrate" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">中文</a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/alaya-devdocs/en/"><img src="/alaya-devdocs/en/img/alaya-logo.svg" alt="PlatON" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/alaya-devdocs/en/img/alaya-logo.svg" alt="PlatON" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a href="#" role="button" class="menu__link menu__link--sublist"><span>Languages</span></a><ul class="menu__list"><li class="menu__list-item"><a href="/alaya-devdocs/en/DApp_migrate" target="_self" rel="noopener noreferrer" class="menu__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li class="menu__list-item"><a href="/alaya-devdocs/zh-CN/DApp_migrate" target="_self" rel="noopener noreferrer" class="menu__link" style="text-transform:capitalize">中文</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/alaya-devdocs/en/">Overview</a></li><li class="menu__list-item"><a class="menu__link" href="/alaya-devdocs/en/Glossary">Glossary</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Intro_to_Alaya">Intro to Alaya</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Intro_to_ATP">Intro to ATP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/staking_and_delegation">Staking&amp;Delegation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Networks">Networks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Alaya_Account">Alaya Account</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Advanced</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Architecture">Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Economic_model">Economic Model</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Consensus_mechanism">Consensus mechanism</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Governance_mechanism">Governance mechanism</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Alaya Node</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Intro_to_validator">Intro to validator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Run_a_fullnode">Run a fullnode</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Become_Validator">Staking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Data_snapshot">Data snapshot</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Tools for nodes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Online_MTool">Online MTool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Offline_MTool">Offline MTool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Command_Line_Tools">Alaya Command line tools</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Developers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Development_guide">Development guide</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Set up local environment</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Join_the_dev_network">Join the dev network</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Run_a_dev_node">Run a dev node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Private_network">Private network</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Dev Tools</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Alaya-Truffle">Alaya-Truffle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/IDE">IDE</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Smart contract</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Solidity contract</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Solidity_Getting_started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Solidity_Migration_tutorial">Migration tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Solidity_Development_costs">Development costs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Solidity_Best_practices">Best practices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Solidity_Contract_security">Contract security</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Wasm contract</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Wasm_Getting_started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Wasm_Development_costs">Development costs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Wasm_Best_practices">Best practices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Wasm_API">Wasm API</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">References</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/JS_SDK">JS SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Java_SDK">Java SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Python_SDK">Python SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Go_SDK">Go SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Json_Rpc">JSON RPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Explorer_API">Explorer API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Samurai_API">Samurai API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">ARC Token</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/ARC20">ARC20</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/ARC721">ARC721</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/alaya-devdocs/en/JS-Tutorials">Getting Started with JS SDK</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/alaya-devdocs/en/DApp_migrate">DApp Quick Migration Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/alaya-devdocs/en/WalletConnect_Tutorial">WalletConnect</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Data and analytics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/AlayScan">AlayScan</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/PlatEye">PlatEye</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Wallet</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Wallet_Guide">Wallet Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/ATON_user_manual">ATON Wallet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Samurai_user_manual">Samurai</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Community</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Join_the_Community">Join the Community</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Ecosystem_Programs">Ecosystem Programs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Ways_to_contribute">Ways to contribute</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/alaya-devdocs/en/Contribution_Guidelines">Contribution Tutorial</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">DApp Quick Migration Tutorial</h1></header><p><em>Note: This article is based on Alaya DevNet nodes that have been upgraded to an Ethereum-compatible version（0.16.1）. The Ethereum-compatible version of the Alaya mainnet is expected to be released in mid-November.</em></p><p>To help developers migrate their Ethereum DApps onto the Alaya network, we will introduce the differences between the two networks and the general outline of DApp migration from the perspective of developers. Furthermore, we will also offer a specific illustration of how DApp contracts and front-end interfaces can be migrated through the existing Ethereum development tools through the example of Uniswap.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="differences-between-alaya-and-ethereum"></a>Differences Between Alaya and Ethereum<a class="hash-link" href="#differences-between-alaya-and-ethereum" title="Direct link to heading">#</a></h2><p>On Alaya, for DApp developers, the amount of work involved in migration has been significantly reduced and the migration process has become smoother because the network has made adjustments for Ethereum.</p><ul><li>The Alaya network generates one block in about 1 second, which is faster than Ethereum. As such, the unit of block timestamp on Alaya is millisecond, whereas Ethereum’s block timestamp is measured in seconds.</li><li>Token unit: Alaya has replaced Ethereum’s wei and ether with von and atp.</li><li>The format of account address: PlatON and Alaya support EIP55 as well as Bech32.</li><li>Currently, the Alaya network does not offer any infrua-like service, and there is only one interface service available to the public: <a href="https://openapi.alaya.network/rpc" target="_blank" rel="noopener noreferrer">https://openapi.alaya.network/rpc</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="an-outline-of-dapp-migration"></a>An Outline of DApp Migration<a class="hash-link" href="#an-outline-of-dapp-migration" title="Direct link to heading">#</a></h2><p>To successfully migrate your DApps, please refer to the below outline:</p><ol><li><p>Before getting started, you should first identify the primary functions of the DApp to be migrated and order them into a sequence based on their functional dependency. In the case of Uniswap, the functional dependency is as follows: **Add the configuration of the Alaya (test) network to Metamask (<a href="https://devdocs.alaya.network/alaya-devdocs/zh-CN/Join_the_dev_network" target="_blank" rel="noopener noreferrer">node information</a>)-&gt; connect to the Metamask wallet -&gt; displays tokens and balances on the swap UI -&gt; create trading pairs and add liquidity -&gt; successfully swap -&gt; remove liquidity.</p><p><strong>The configuration of Alaya development test network nodes for Metamask:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token maybe-class-name">Network</span><span class="token plain"> </span><span class="token maybe-class-name">Name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Alaya</span><span class="token plain"> development test network</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">New</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">PRC</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">URL</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> http</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">47.241</span><span class="token number" style="color:rgb(247, 140, 108)">.91</span><span class="token number" style="color:rgb(247, 140, 108)">.2</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">6789</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">Chain</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">ID</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">201030</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Symbol</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">optional</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">ATP</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">Blockchain</span><span class="token plain"> explorer </span><span class="token constant" style="color:rgb(130, 170, 255)">URL</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">optional</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> https</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">devnetscan.alaya.network</span><span class="token regex regex-delimiter">/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>Please follow the steps specified in the section “Migration of Uniswap Contracts” below to migrate the DApp-related contracts and deploy them on your Alaya test network.</p></li><li><p>You should sort out the functional dependencies according to the above process and go through the “Uniswap front-end migration”, and debug through each function.</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="an-example-of-dapp-migration"></a>An Example of DApp migration<a class="hash-link" href="#an-example-of-dapp-migration" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="uniswap-migration"></a>Uniswap Migration<a class="hash-link" href="#uniswap-migration" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="introduction-to-uniswap-migration"></a>Introduction to Uniswap Migration<a class="hash-link" href="#introduction-to-uniswap-migration" title="Direct link to heading">#</a></h4><p>To help developers carry out DApp migration, we have worked out a specific illustration of the migration process and modification points using Uniswap as an example. Compared with other DApps. Therefore, an example of Uniswap migration covers most of the procedures involved in DApp migration.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="the-operation-process-of-uniswap"></a>The operation process of Uniswap<a class="hash-link" href="#the-operation-process-of-uniswap" title="Direct link to heading">#</a></h4><ul><li>Firstly, you should connect to the Metamask wallet and select the account to be connected through authorization. Once you have successfully connected to Metamask, the front-end interface of Uniswap will display your account and the native token balance of the account.</li><li>On the swap interface, you can click “Select a token” to check the account balance of different tokens.</li><li>On the pool interface, you can create trading pairs and add liquidity, which requires authorization such as Metamask permission and signature. Afterward, the interface will display the trading pairs and add liquidity you created. Next, you can click “remove” on the page of liquidity specifics and reduce a certain proportion of the liquidity.</li><li>Then, you can switch back to the swap interface and swap the tokens included in the trading pairs you created, which requires Metamask signature.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="migration-of-uniswap-contracts"></a>Migration of Uniswap contracts<a class="hash-link" href="#migration-of-uniswap-contracts" title="Direct link to heading">#</a></h4><p>For the migration of contract code, please refer to: <a href="https://github.com/treelaketreelake/swap-contracts" target="_blank" rel="noopener noreferrer">https://github.com/treelaketreelake/swap-contracts</a></p><p>The specific procedures of contract deployment are as follows:</p><ul><li><strong>Install nodejs</strong></li></ul><p>Install nodejs by executing the following commands:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">wget</span><span class="token plain"> https://nodejs.org/download/release/v10.18.1/node-v10.18.1-linux-x64.tar.gz</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> -zxvf node-v10.18.1-linux-x64.tar.gz -C /usr/local</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">ln</span><span class="token plain"> -s /usr/local/node-v10.18.1-linux-x64/bin/* /usr/bin/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ node -v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:rgb(247, 140, 108)">777</span><span class="token plain"> /usr/local/node-v10.18.1-linux-x64/bin</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:rgb(247, 140, 108)">777</span><span class="token plain"> /usr/local/node-v10.18.1-linux-x64/lib/node_modules/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><strong>Install truffle</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -g truffle</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">truffle -version</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><strong>Modify the chain-relevant configurations</strong></li></ul><p>Modify the config file in the package: Change the value of feeToSetter in migrations/2_deploy_contracts.js into the contract deployer:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> feeToSetter</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0xef8ff83e1510DDaD35Db33efa6735F0a9C94ca74&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Entitled to modify the account of the feeTo address and is the current contract deployer</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><strong>Modify the chain-relevant configurations</strong></li></ul><p>Change the chain-relevant configurations in uniswap-apt/truffle-config.js:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token maybe-class-name">HDWalletProvider</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@truffle/hdwallet-provider&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    networks</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        development</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">provider</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">HDWalletProvider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;bdbcca45b8af0b751bb39657a005c9ed4341ed7bc15ac6eb37a84b7fd12fcc07&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token template-string string" style="color:rgb(195, 232, 141)">http://47.241.91.2:6789</span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            network_id</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;*&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Any network (default: none)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Set default mocha options here, use special reporters etc.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  mocha</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// timeout: 100000</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configure your compilers</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  compilers</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    solc</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        version</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;^0.5.17&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Fetch exact version from solc-bin (default: truffle&#x27;s version)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// docker: true,        // Use &quot;0.5.1&quot; you&#x27;ve installed locally with docker (default: false)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        settings</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// See the solidity docs for advice about optimization and evmVersion</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          optimizer</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            enabled</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            runs</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">200</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//  evmVersion: &quot;byzantium&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><strong>Compile the relevant contracts of Uniswap</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">truffle compile</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Note: Considering that the underlying code of the Alaya network currently supports solidity 0.8.6, we recommend the use of 0.8.6 or older solidity versions when compiling relevant operation contracts</strong></p><ul><li><strong>Deploy contracts that relate to the Uniswap trading pairs</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">truffle migrate --f </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> --to </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> --skip-dry-run</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Note: You may need to modify the field of init code hash in the pairFor function that is within the libraries/UniswapV2Library.sol contract. The field may differ according to the different user addresses that have been deployed. However, for the same address, it will remain the same during multiple deployments. init code hash is needed when generating the pair address. Additionally, as the field exists in both the Uniswap code and the @uniswap/sdk dependency library, it must be consistent, otherwise, the subsequent operation logic invocation of the contract will be affected and trigger bugs.</strong></p><ul><li><strong>Record and deploy the contract address information</strong></li></ul><p>Below is the output information from testing in actual deployment:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">uniswapV2Factory at</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xB5bDf1dDf5a4Cfa3C534fFaBD201643093775889</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token constant" style="color:rgb(130, 170, 255)">WETH</span><span class="token plain"> at</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xE90A2e39255A3879607b77b652d80aAC89D3A18a</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">uniswapV2Router02 at</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x6E5a8fd360b5f3c6cA51F20d3bbC93C862A7b9CF</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">Multicall</span><span class="token plain">  at</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x6E7C672457bBea5fA0b8815944C9575Bd52385Ca</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">initHash is at</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x2d2546605b9f2d8c64755e6b9c29cc742d5f0b74bad6d7b8c188c2ccd0822fad</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="modification-of-the-uniswap-dependency-library"></a>Modification of the Uniswap dependency library<a class="hash-link" href="#modification-of-the-uniswap-dependency-library" title="Direct link to heading">#</a></h4><ul><li>Package name: uniswap-sdk</li><li>Source code address: <a href="https://github.com/Uniswap/v2-sdk/tree/a88048e9c4198a5bdaea00883ca00c8c8e582605" target="_blank" rel="noopener noreferrer">https://github.com/Uniswap/v2-sdk/tree/a88048e9c4198a5bdaea00883ca00c8c8e582605</a></li></ul><ul><li><p>Modification points:</p><ul><li><p>src/constants.ts (line 7/28)</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">FACTORY_ADDRESS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0xB5bDf1dDf5a4Cfa3C534fFaBD201643093775889&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">INIT_CODE_HASH</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x2d2546605b9f2d8c64755e6b9c29cc742d5f0b74bad6d7b8c188c2ccd0822fad&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul><p>Replace the above FACTORY_ADDRESS and INIT_CODE_HASH with the corresponding data generated from the new deployment</p></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">enum</span><span class="token plain"> </span><span class="token maybe-class-name">ChainId</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token constant" style="color:rgb(130, 170, 255)">MAINNET</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token constant" style="color:rgb(130, 170, 255)">ROPSTEN</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token constant" style="color:rgb(130, 170, 255)">RINKEBY</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token constant" style="color:rgb(130, 170, 255)">G</span><span class="token plain">Ö</span><span class="token constant" style="color:rgb(130, 170, 255)">RLI</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token constant" style="color:rgb(130, 170, 255)">KOVAN</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">42</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token constant" style="color:rgb(130, 170, 255)">ALAYA</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">201030</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>  Add the chainId enumerators of the Alaya development test network to the above ChianId</p><ul><li>src/entities/token.ts(63行)</li><li>src/entities/token.ts (line 63)</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">WETH</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token maybe-class-name">ChainId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">ALAYA</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token maybe-class-name">ChainId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">ALAYA</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0xE90A2e39255A3879607b77b652d80aAC89D3A18a&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token number" style="color:rgb(247, 140, 108)">18</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;WETH&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Wrapped ETH&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Replace the above address with the WETH token address generated in the new deployment.</p><p>The modification process will be completed once the dist directory of dependencies previously installed has been replaced with the dist directory generated through compilation, which takes place after the code of the dependency packages is modified.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="modification-of-uniswaps-front-end-code"></a>Modification of Uniswap’s front-end code<a class="hash-link" href="#modification-of-uniswaps-front-end-code" title="Direct link to heading">#</a></h4><ul><li>src/connectors/index.ts (line 30)</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> injected </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">InjectedConnector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  supportedChainIds</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">42</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">201030</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Add the corresponding chainId of the Alaya development test network to supportedChainIds.</p><ul><li>src/constants/index.ts (line 6/29/30/32)</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">ROUTER_ADDRESS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x6E5a8fd360b5f3c6cA51F20d3bbC93C862A7b9CF&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Replace the above ROUTER_ADDRESS with the router contract address generated from the new deployment.</p><ul><li>src/constants/multicall/index.ts (line 10)</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token maybe-class-name">ChainId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">ALAYA</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x6E7C672457bBea5fA0b8815944C9575Bd52385Ca&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Add the Alaya development test network and the corresponding multicall contract address to MULTICALL_NETWORKS.</p><ul><li>src/constants/list.ts (line 2)</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">DEFAULT_TOKEN_LIST_URL</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;http://10.1.1.50:8080/token-list.json&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>src/hooks/useTimestampFromBlock.ts (line 11)</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">blockData </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">setTimestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">blockData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">timestamp</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The timestamp in block info should be divided by 1,000 as the unit of block timestamp on Alaya is millisecond, whereas Ethereum’s block timestamp is measured in seconds.</p><ul><li>src/hooks/useTransactionDeadline.ts (line 12)</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">blockTimestamp </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> ttl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> blockTimestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ttl </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>blockTimeStamp should be multiplied by 1,000 as the unit of block timestamp on Alaya is millisecond, whereas Ethereum’s block timestamp is measured in seconds.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="conclusion-for-uniswap-migration"></a>Conclusion for Uniswap migration<a class="hash-link" href="#conclusion-for-uniswap-migration" title="Direct link to heading">#</a></h4><ul><li>Add the Alaya network configuration to the swap source code and the @uniswap/sdk dependency library, which makes Uniswap support the Alaya development test network with the chainId of 201030.</li><li>Modify the corresponding code for init code hash in UniswapV2Library, which is the dependency contract of operation-relevant contracts, and then deploy the operation-relevant contracts (uniswapV2Factory/WETH/uniswapV2Router/multicall) to get the address of the relevant contracts (special attention should be paid to the solidity version).</li><li>Replace the relevant operation contract address in the swap source code (uniswapV2Factory/WETH/uniswapV2Router/multicall/initHash).</li><li>Replace the relevant operation contract address in the @uniswap/sdk code (uniswapV2Factory/WETH/uniswapV2Router/multicall/initHash).</li><li>The required changes in swap source code that relates to blocktimestamp.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="conclusion-for-dapp-migration"></a>Conclusion for DApp migration<a class="hash-link" href="#conclusion-for-dapp-migration" title="Direct link to heading">#</a></h2><p>According to the above modification points of Uniswap, we can teel that most of the changes adopted for DApp operations. For instance, this includes the necessary changes of network configuration for supporting the new network in terms of code. Another example of this is that the operation-relevant contract address should also be modified due to the differences caused by redeployment. Of course, you can always deploy and generate fixed contract addresses using fixed accounts in the actual production environment, which requires no replacement. Considering the strong correlation between the above modifications and DApp operations, it is essential for you to learn more about the operation logic of DApps, which can be very helpful for debugging when certain modifications have been omitted. Additionaly, you should also be very careful with the unit difference between Alaya and Ethereum in terms of blocktimestamp (if it is involved in the operation code). Overall, the migration process is pretty smooth. As long as you have learned about the operation logic of DApps in advance, the relevant modifications during migration should be effortless.</p><p><em>English Translation Contributors @<a href="https://github.com/WillXing" target="_blank" rel="noopener noreferrer">WillXing</a></em></p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/AlayaNetwork/alaya-devdocs/tree/main/website/docs/DApp_Migration_Tutorial.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/alaya-devdocs/en/JS-Tutorials"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Getting Started with JS SDK</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/alaya-devdocs/en/WalletConnect_Tutorial"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">WalletConnect »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#differences-between-alaya-and-ethereum" class="table-of-contents__link">Differences Between Alaya and Ethereum</a></li><li><a href="#an-outline-of-dapp-migration" class="table-of-contents__link">An Outline of DApp Migration</a></li><li><a href="#an-example-of-dapp-migration" class="table-of-contents__link">An Example of DApp migration</a><ul><li><a href="#uniswap-migration" class="table-of-contents__link">Uniswap Migration</a></li></ul></li><li><a href="#conclusion-for-dapp-migration" class="table-of-contents__link">Conclusion for DApp migration</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="https://www.alaya.network/en" target="_blank" class="footer-logo-home" rel="noreferrer noopener"><img src="/alaya-devdocs/en/img/alaya-logo.svg" width="66" height="58"></a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="https://www.alaya.network/en" target="_blank" rel="noopener noreferrer" class="footer__link-item" hrefzh="https://www.alaya.network/">Alaya network</a></li><li class="footer__item"><a href="https://latticex.foundation/home" target="_blank" rel="noopener noreferrer" class="footer__link-item" hrefzh="https://latticex.foundation/home">LatticeX.Foundation</a></li><li class="footer__item"><a href="https://forum.latticex.foundation/" target="_blank" rel="noopener noreferrer" class="footer__link-item" hrefzh="https://forum.latticex.foundation/">Forum</a></li></ul></div><div class="gitstar"><a class="github-button" href="https://github.com/PlatONnetwork/PlatON-Go" data-color-scheme="no-preference: light; light: light; dark: light;" data-icon="octicon-star" data-size="small" data-show-count="true" aria-label="Star PlatONnetwork/PlatON-Go on GitHub">Star</a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">COPYRIGHT  © 2021 Alaya NETWORK.</div></div></div></footer></div>
<script src="/alaya-devdocs/en/assets/js/runtime~main.e78dac4f.js"></script>
<script src="/alaya-devdocs/en/assets/js/main.a9c09545.js"></script>
</body>
</html>